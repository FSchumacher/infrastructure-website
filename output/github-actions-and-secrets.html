<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <title>GitHub Actions and Secrets</title>
        <link rel="stylesheet" href="https://infra.apache.org/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://infra.apache.org/">Apache Infrastructure</a></h1>
                <nav><ul>
                    <li><a href="https://infra.apache.org/./oauth-two-factor-authentication.html">OAuth Two-Factor Authentication</a></li>
                    <li><a href="https://infra.apache.org/./asf-account-management.html">ASF account management</a></li>
                    <li><a href="https://infra.apache.org/./apache-and-github.html">Apache and GitHub</a></li>
                    <li><a href="https://infra.apache.org/./application-upgrades-policy-and-workflow.html">Application upgrades policy and workflow</a></li>
                    <li><a href="https://infra.apache.org/./distributing-through-the-apple-developer-program.html">Distributing through the Apple Developer Program</a></li>
                    <li><a href="https://infra.apache.org/./applying-the-apache-license-version-20.html">Applying the Apache license, version 2.0</a></li>
                    <li><a href="https://infra.apache.org/./asf-pelican-build-process.html">ASF-Pelican build process</a></li>
                    <li><a href="https://infra.apache.org/./configuring-asf-pelican.html">Configuring ASF Pelican</a></li>
                    <li><a href="https://infra.apache.org/./asf-pelican-data-model.html">ASF Pelican data model</a></li>
                    <li><a href="https://infra.apache.org/./asf-pelican-getting-started-guide.html">ASF-Pelican getting-started guide</a></li>
                    <li><a href="https://infra.apache.org/./local-pelican-builds.html">Local Pelican builds</a></li>
                    <li><a href="https://infra.apache.org/./asf-pelican-plugins.html">ASF Pelican plugins</a></li>
                    <li><a href="https://infra.apache.org/./apache-theme-for-asf-pelican.html">Apache Theme for ASF Pelican</a></li>
                    <li><a href="https://infra.apache.org/./asf-pelican.html">ASF-Pelican</a></li>
                    <li><a href="https://infra.apache.org/./asfbot-irc-services-and-archives.html">ASFBot: IRC services and archives</a></li>
                    <li><a href="https://infra.apache.org/./project-sites-using-mkdocs.html">Project sites using MKDocs</a></li>
                    <li><a href="https://infra.apache.org/./backup-policy.html">Backup policy</a></li>
                    <li><a href="https://infra.apache.org/./writing-a-good-bug-report.html">Writing a good bug report</a></li>
                    <li><a href="https://infra.apache.org/./committer-email.html">Committer Email</a></li>
                    <li><a href="https://infra.apache.org/./policy-for-outreach-to-committers.html">Policy for Outreach to Committers</a></li>
                    <li><a href="https://infra.apache.org/./committers-faqs.html">Committers' FAQs</a></li>
                    <li><a href="https://infra.apache.org/./contact-the-infrastructure-team.html">Contact the Infrastructure Team</a></li>
                    <li><a href="https://infra.apache.org/./tips-for-apache-project-email-contributors.html">Tips for Apache project email contributors</a></li>
                    <li><a href="https://infra.apache.org/./guide-for-new-project-contributors.html">Guide for new project contributors</a></li>
                    <li><a href="https://infra.apache.org/./handling-cryptography-within-an-asf-release.html">Handling cryptography within an ASF release</a></li>
                    <li><a href="https://infra.apache.org/./confluence-wiki-space-for-your-project.html">Confluence Wiki space for your project</a></li>
                    <li><a href="https://infra.apache.org/./requesting-access-to-the-digicert-code-signing-service.html">Requesting access to the Digicert code signing service</a></li>
                    <li><a href="https://infra.apache.org/./using-the-digicert-code-signing-service.html">Using the Digicert code signing service</a></li>
                    <li><a href="https://infra.apache.org/./documentation.html">Documentation</a></li>
                    <li><a href="https://infra.apache.org/./docker-hub-use-policy.html">Docker Hub use policy</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/email.html">Committer e-mail configuration</a></li>
                    <li><a href="https://infra.apache.org/./fingerprints.html">Fingerprints</a></li>
                    <li><a href="https://infra.apache.org/./github-flavored-markdown.html">GitHub Flavored Markdown</a></li>
                    <li><a href="https://infra.apache.org/./getting-started-with-git.html">Getting started with Git</a></li>
                    <li><a href="https://infra.apache.org/./git-access-to-apache-subversion-codebases.html">Git access to Apache Subversion codebases</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/git.html">Getting started with Git</a></li>
                    <li><a href="https://infra.apache.org/./github-actions-policy.html">GitHub Actions Policy</a></li>
                    <li class="active"><a href="https://infra.apache.org/./github-actions-and-secrets.html">GitHub Actions and Secrets</a></li>
                    <li><a href="https://infra.apache.org/./github-pages-for-projects.html">GitHub Pages for projects</a></li>
                    <li><a href="https://infra.apache.org/./roles-for-project-github-repositories.html">Roles for project GitHub repositories</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/github.html">Apache and GitHub</a></li>
                    <li><a href="https://infra.apache.org/./glossary.html">Glossary</a></li>
                    <li><a href="https://infra.apache.org/./host-a-jenkins-or-buildbot-agent.html">Host a Jenkins or Buildbot agent</a></li>
                    <li><a href="https://infra.apache.org/./how-to-mirror-asf-software-releases-locally.html">How to mirror ASF software releases locally</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/id.html">Changing your account details (self serve)</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/index.html">Committer Documentation</a></li>
                    <li><a href="https://infra.apache.org/./reference/index.html">Reference Documentation</a></li>
                    <li><a href="https://infra.apache.org/./site-wide-ban-policy.html">Site-wide ban policy</a></li>
                    <li><a href="https://infra.apache.org/./details-on-contacting-infra.html">Details on contacting Infra</a></li>
                    <li><a href="https://infra.apache.org/./infra-and-the-incubator.html">Infra and the Incubator</a></li>
                    <li><a href="https://infra.apache.org/./apache-infrastructure-mailing-lists.html">Apache Infrastructure mailing lists</a></li>
                    <li><a href="https://infra.apache.org/./volunteering-for-apache-infrastructure.html">Volunteering for Apache Infrastructure</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/jenkins-docker.html">Using Docker with builds.apache.org</a></li>
                    <li><a href="https://infra.apache.org/./guidelines-for-creating-a-jira-ticket.html">Guidelines for creating a Jira ticket</a></li>
                    <li><a href="https://infra.apache.org/./how-to-transition-to-a-new-pgp-key.html">How to transition to a new PGP key</a></li>
                    <li><a href="https://infra.apache.org/./assembling-license-and-notice-files.html">Assembling LICENSE and NOTICE files</a></li>
                    <li><a href="https://infra.apache.org/./localization.html">Localization</a></li>
                    <li><a href="https://infra.apache.org/./machines-and-fingerprints.html">Machines and Fingerprints</a></li>
                    <li><a href="https://infra.apache.org/./mailing-list-migration-project.html">Mailing List Migration Project</a></li>
                    <li><a href="https://infra.apache.org/./mail-rejection-policy.html">Mail Rejection Policy</a></li>
                    <li><a href="https://infra.apache.org/./mailing-list-moderation.html">Mailing list moderation</a></li>
                    <li><a href="https://infra.apache.org/./managing-project-committers.html">Managing Project Committers</a></li>
                    <li><a href="https://infra.apache.org/./apache-download-mirror-system.html">Apache download mirror system</a></li>
                    <li><a href="https://infra.apache.org/./guide-for-new-project-committers.html">Guide for new project committers</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/newaccount.html">Guide to new committers</a></li>
                    <li><a href="https://infra.apache.org/./nexus-101.html">Nexus 101</a></li>
                    <li><a href="https://infra.apache.org/./open-access-svn.html">Open-access SVN</a></li>
                    <li><a href="https://infra.apache.org/./cryptography-with-openpgp.html">Cryptography with OpenPGP</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/opie.html">Using OPIE</a></li>
                    <li><a href="https://infra.apache.org/./operating-system-upgrade-policy.html">Operating system upgrade policy</a></li>
                    <li><a href="https://infra.apache.org/./how-to-submit-a-patch-for-project-code.html">How to submit a patch for project code</a></li>
                    <li><a href="https://infra.apache.org/./build-and-manage-a-project-website-with-pelican-and-buildbot.html">Build and manage a project website with Pelican and Buildbot</a></li>
                    <li><a href="https://infra.apache.org/./infra-policies.html">Infra policies</a></li>
                    <li><a href="https://infra.apache.org/./project-blog.html">Project Blog</a></li>
                    <li><a href="https://infra.apache.org/./project-and-product-names.html">Project and product names</a></li>
                    <li><a href="https://infra.apache.org/./project-code-repository-policy.html">Project Code Repository Policy</a></li>
                    <li><a href="https://infra.apache.org/./project-site-policy.html">Project site policy</a></li>
                    <li><a href="https://infra.apache.org/./managing-your-project-web-site.html">Managing your project web site</a></li>
                    <li><a href="https://infra.apache.org/./publishing-maven-releases-to-maven-central-repository.html">Publishing Maven Releases to Maven Central Repository</a></li>
                    <li><a href="https://infra.apache.org/./subscribe-to-apache-software-foundation-infrastructure-events.html">Subscribe to Apache Software Foundation infrastructure events</a></li>
                    <li><a href="https://infra.apache.org/./release-distribution-policy.html">Release Distribution Policy</a></li>
                    <li><a href="https://infra.apache.org/./release-download-pages-for-projects.html">Release Download Pages for Projects</a></li>
                    <li><a href="https://infra.apache.org/./release-creation-process.html">Release Creation Process</a></li>
                    <li><a href="https://infra.apache.org/./signing-releases.html">Signing Releases</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/release.html">Releasing project packages</a></li>
                    <li><a href="https://infra.apache.org/./apache-maven-repositories.html">Apache Maven repositories</a></li>
                    <li><a href="https://infra.apache.org/./requesting-an-issue-and-feature-request-tracker-for-a-project.html">Requesting an issue and feature-request tracker for a project</a></li>
                    <li><a href="https://infra.apache.org/./response-time.html">Response time</a></li>
                    <li><a href="https://infra.apache.org/./roadmap-for-apache-infrastructure.html">Roadmap for Apache Infrastructure</a></li>
                    <li><a href="https://infra.apache.org/./self-hosted-runners.html">Self-hosted runners</a></li>
                    <li><a href="https://infra.apache.org/./services-and-tools.html">Services and Tools</a></li>
                    <li><a href="https://infra.apache.org/./slack-for-asf-projects.html">Slack for ASF projects</a></li>
                    <li><a href="https://infra.apache.org/./dealing-with-spam-in-your-asf-email-account.html">Dealing with spam in your ASF email account</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/start.html">Committer documentation</a></li>
                    <li><a href="https://infra.apache.org/./status-pages.html">Status pages</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/subversion.html">Using Subversion</a></li>
                    <li><a href="https://infra.apache.org/./subversion-basics.html">Subversion basics</a></li>
                    <li><a href="https://infra.apache.org/./svn-to-git-migration.html">SVN to Git migration</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/svngit2jira.html">Subversion and Git integration with JIRA tickets</a></li>
                    <li><a href="https://infra.apache.org/./subversion-and-git-integration-with-jira-tickets.html">Subversion and Git integration with Jira tickets</a></li>
                    <li><a href="https://infra.apache.org/./about-the-apache-infrastructure-team.html">About the Apache Infrastructure Team</a></li>
                    <li><a href="https://infra.apache.org/./understanding-opensource.html">Understanding Opensource</a></li>
                    <li><a href="https://infra.apache.org/./user-documentation-for-project-releases.html">User documentation for project releases</a></li>
                    <li><a href="https://infra.apache.org/./committer-ssh-access.html">Committer SSH Access</a></li>
                    <li><a href="https://infra.apache.org/./source-code-repositories-at-apache.html">Source Code Repositories at Apache</a></li>
                    <li><a href="https://infra.apache.org/./requesting-a-virtual-machine-for-a-project.html">Requesting a virtual machine for a project</a></li>
                    <li><a href="https://infra.apache.org/./managing-virtual-machines.html">Managing virtual machines</a></li>
                    <li><a href="https://infra.apache.org/./project-vm-policy.html">Project VM policy</a></li>
                    <li><a href="https://infra.apache.org/./guidelines-for-project-websites.html">Guidelines for project websites</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/website-policy.html">Web Site Guidelines</a></li>
                    <li><a href="https://infra.apache.org/./reference/committer/website.html">How To Manage any Apache Project's Website</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
    <h1 class="entry-title">GitHub Actions and Secrets</h1>
    
    <p><strong>Notice</strong>: December 27, 2020: We only allow Actions that are official "Made by GitHub" or local to the Apache org on GitHub, to address a potential security vulnerability. This  is an incident-related policy change. We are researching the situation, and the policy may evolve based on what we learn.</p>
<p><strong>GitHub <a href="https://help.github.com/en/actions/getting-started-with-github-actions/about-github-actions" target="_blank">Actions</a></strong> help you automate your software development workflows in the same place you store code and collaborate on pull requests and issues. You can write individual tasks, called actions, and combine them to create a custom workflow. Workflows are custom automated processes that you can set up in your repository to build, test, package, release, or deploy any code project on GitHub.</p>
<p><strong><em>A note on testing</em></strong>: Some projects would like to use GitHub Actions for complex processes, such as automating their tests of software builds. </p>
<p>The <em>time</em> runners are in use (measured in minutes) is unlimited for public repositories so how long a test takes isn't the issue. The issue is tying up limited 'runners' (nodes) while those minutes are running. Apache has 180 runners for over 1200 repositories, so the concern would be how many runners the test requires, which are then unavailable to other projects for the duration of the test. Out of those 180 runners, only 50 Mac OS runners can be in use at one time for all ASF projects.</p>
<p>The ASF maxes out its runner allocation quite often, so a project needs to plan carefully to make best use of them for everyone's sake. For example, it would be important not to trigger a full release test with a pull request that is correcting a typo on one page in one module.</p>
<p><strong>Evolving knowledge</strong></p>
<ul>
<li>
<p>If you are considering using GitHub Actions with buildsy, please subscribe to the <code>builds@ a.o</code> mailing list, where there is a continuing discussion on this topic and others related to continuious integration development.</p>
</li>
<li>
<p>The community is curating a <a href="https://cwiki.apache.org/confluence/display/BUILDS/GitHub+Actions+status" target="_blank">Wiki page</a> about the current state of using GitHub Actions for ASF projects.</p>
</li>
<li>
<p>See <a href="https://cwiki.apache.org/confluence/display/INFRA/Github+Actions+to+DockerHub" target="_blank">Apache Airflow's experience</a> with Actions.</p>
</li>
</ul>
<p><strong>GitHub <a href="https://help.github.com/en/actions/configuring-and-managing-workflows/creating-and-storing-encrypted-secrets" target="_blank">Secrets</a></strong> are encrypted environment variables that you create in a repository or organization. The secrets you create are available to use in GitHub Actions workflows.</p>
<p>A <strong>GitHub <a href="https://docs.github.com/en/developers/apps/about-apps#personal-access-tokens" target="_blank">Token</a></strong> is a string of characters that functions similarly to an OAuth token in that you can specify its permissions via scopes. A personal access token is also similar to a password, but you can have many of them and you can revoke access to each one at any time. As an example, you can enable a personal access token to write to your repositories. If then you run a cURL command or write a script that creates an issue in your repository, you would pass the personal access token to authenticate. You can store the personal access token as an environment variable to avoid typing it every time you use it.</p>
<p>See <a href="https://cwiki.apache.org/confluence/display/INFRA/Github+Secrets+and+Tokens" target="_blank">GitHub secrets and tokens</a>.</p>
<h3>Examples</h3>
<h4>GitHub Secrets</h4>
<p><a href="https://arrow.apache.org/" target="_blank">Apache Arrow</a> has GitHub Secrets added to their Arrow GitHub repos with the name 'DOCKERHUB_USER' and token 'DOCKERHUB_TOKEN' created as the user account on DockerHub (those account details are in LP).
Additionally, in DockerHub, an 'arrow-dev' repository was created and the DockerHub 'jenkins' team (containing  the DockerHub 'DOCKERHUB_USER' user) was given admin access.</p>
<h4>GitHub Actions</h4>
<p>Using Apache Arrow again as an example, the tokens above can be called using this code:</p>
<div class="highlight"><pre><span></span><code>run: |
docker login -u <span class="cp">${</span><span class="p">{</span> <span class="n">secrets</span><span class="o">.</span><span class="n">DOCKERHUB_USER</span> <span class="cp">}</span>} \
-p <span class="cp">${</span><span class="p">{</span> <span class="n">secrets</span><span class="o">.</span><span class="n">DOCKERHUB_TOKEN</span> <span class="cp">}</span>}
docker-compose push ...
</code></pre></div>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>